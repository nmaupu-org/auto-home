---
# Configure DHCP server (dnsmasq)
# Parameter: dictionary containing target interface and associated configuration

- name: "{{ item.key }} - Deleting old/default DHCP configuration"
  uci:
    command: delete
    key: dhcp.{{ item.key }}
  notify: restart dhcp

- name: "{{ item.key }} - Adding DHCP entry"
  uci:
    command: set
    key: dhcp.{{ item.key }}
    value: dhcp
  notify: restart dhcp

- name: "{{ item.key }} Configuring DHCP entry"
  uci:
    command: set
    key: dhcp.{{ item.key }}
    value: "{{ item.value }}"
  notify: restart dhcp
